  This is the second request/response that is sent.

The purpose of this exchange is for a client to obtain a `Service Ticket` (ST) using the previously obtained `Ticket Granting Ticket` (TGT) and `TGS Session Key`. This interaction happens with the `Ticket Granting Service` (TGS).

Entities involved:
 - Client
 - TGS/KDC

 Messages:
 - TGS-REQ (Ticket Granting Service Request), Client -> TGS
 - TGS-REP (Ticket Granting Service Reply), TGS -> Client
 ---
# TGS-REQ

  The TGS-REQ contains:
 - The `TGT` that was generated by the `AS` in the first exchange
 - The `service principal name` of the requested service and the desired `lifetime` for the ST.
 - The `authenticator data`, which includes the userID and the timestamp, encrypted with the `TGS Session Key`.

  Example of an TGS-REQ package
```sh
  
 tgs-req
     pvno: 5
     msg-type: krb-tgs-req (12)
     padata: 2 items
         PA-DATA pA-TGS-REQ
             padata-type: pA-TGS-REQ (1)
                 padata-value: 6e82058430820580a003020105a10302010ea20703050000000000a38204c8618204c430â€¦
                     ap-req
                         pvno: 5
                         msg-type: krb-ap-req (14)
                         Padding: 0
                         ap-options: 00000000
                         ticket
                         authenticator
         PA-DATA pA-PAC-OPTIONS
     req-body
         Padding: 0
         kdc-options: 40800000
         realm: HEXDUMP.LAB
         sname
             name-type: kRB5-NT-SRV-INST (2)
             sname-string: 3 items
                 SNameString: ldap
                 SNameString: dc01.hexdump.lab
                 SNameString: hexdump.lab
         till: Sep 13, 2037 04:48:05.000000000 CEST
         nonce: 1960024827
         etype: 5 items
         enc-authorization-data
  
```

---
# TGS-REP
  
Once the TGS receives the message, it performs the following operations:
 - Decrypts TGT with TGS secret.
 - Reads TGS Session key from TGT
 - Decrypts authenticator data with TGS Session Key
 - Validates authenticator data with TGT data
 - Prepares `ST(Service Ticket)` encrypted with `service secret key`.
 - Encrypts (ServiceID + Service Session Key) with `TGS Session key'.

  Example of an TGS-REP packet
```sh

 tgs-rep
     pvno: 5
     msg-type: krb-tgs-rep (13)
     crealm: HEXDUMP.LAB
     cname
         name-type: kRB5-NT-PRINCIPAL (1)
         cname-string: 1 item
     ticket
         tkt-vno: 5
         realm: HEXDUMP.LAB
         sname
             name-type: kRB5-NT-SRV-INST (2)
             sname-string: 3 items
                 SNameString: ldap
                 SNameString: dc01.hexdump.lab
                 SNameString: hexdump.lab
         enc-part
     enc-part
```