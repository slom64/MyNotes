
# OU

- a user having the **GenericAll** right (and thus **WriteDACL** permissions) over an OU could add a **FullControl** ACE to the OU and specify that this ACE should be inherited, which will effectively lead to the compromise of all child objects since they will inherit said ACE
- One of the additional security mechanisms applied on protected objects is that **ACE inheritance from parent objects is disabled for such objects**. In other words, if an ACE is applied on a parent object such as an OU and configured to be inherited, all child objects with the `adminCount=1` attribute will still refuse to apply it.

> [!important] ACE inheritance
> If attacker can write an ACE (`WriteDacl`) for a container or organisational unit (OU), if inheritance flags are added (`0x01+ 0x02`) to the ACE, and inheritance is enabled for an object in that container/OU, the ACE will be applied to it. By default, all the objects with `AdminCount=0` will inherit ACEs from their parent container/OU.
> 
> Impacket's dacledit (Python) can be used with the `-inheritance` flag for that purpose ([PR#1291](https://github.com/fortra/impacket/pull/1291)).

> [!important] adminCount=1 (gPLink spoofing)
> In April 2024, [Synacktiv explained](https://www.synacktiv.com/en/publications/ounedpy-exploiting-hidden-organizational-units-acl-attack-vectors-in-active-directory) that if `GenericAll`, `GenericWrite` or `Manage Group Policy Links` privileges are available against an Organisational Unit (OU), then it's possible to compromise its child users and computers with `adminCount=1` through "gPLink spoofing".
> 
> This can be performed with [OUned.py](https://github.com/synacktiv/OUned).



> [!Question] 
> If i have GenericAll, or GenericWrite. where we can change the **Distinguished Name**, can we change the **Distinguished Name** to put the object in different group like admin groups.

NO, you can't:
**Distinguished Name Structure:**
```sh
# CN (Common Name): The object's name, OU (Organizational Unit): The container location, DC (Domain Component): The domain structure
CN=Username,OU=SomeOU,DC=domain,DC=com
```

**What You CANNOT Do:**
```sh
# You CANNOT change this:
CN=Stephen Miller,OU=Security Department,OU=DCHERCULES,DC=hercules,DC=htb

# To this (to make him Domain Admin):
CN=Stephen Miller,CN=Domain Admins,CN=Users,DC=hercules,DC=htb
```

 **What You CAN Do with DN Modification**
```sh
# Move between OUs (same level)
  CN=Stephen Miller,OU=Security Department,OU=DCHERCULES,DC=hercules,DC=htb
→ CN=Stephen Miller,OU=IT Department,OU=DCHERCULES,DC=hercules,DC=htb

# Rename the object (change CN)
  CN=Stephen Miller,OU=Security Department,OU=DCHERCULES,DC=hercules,DC=htb  
→ CN=Hacked User,OU=Security Department,OU=DCHERCULES,DC=hercules,DC=htb
```
