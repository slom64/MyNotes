
- The CA generates its own root CA certificate by signing a new certificate using its private key (that is, the root CA certificate is self-signed). AD CS will set the certificate’s Subject and Issuer fields to the CA’s name, the Basic Constraints to Subject Type=CA, and the NotBefore/NotAfter fields to five years (by default). Hosts then add the root CA certificate to their trust store to build a trust relationship with the CA.
- Our research focused on EKUs that, when present in a certificate, permit authentication to AD. We originally thought that only the Client Authentication OID enabled this; however, our
  research also found that the following OIDs can enable certificate authentication:

| Description                                                                                                                                                                                                                                                                                    | OID                                                                                                                                                 |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| Client Authentication                                                                                                                                                                                                                                                                          | 1.3.6.1.5.5.7.3                                                                                                                                     |
| PKINIT Client Authentication*                                                                                                                                                                                                                                                                  | 1.3.6.1.5.2.3.4<br>This OID is not present in AD CS deployments by default and needs to be addedmanually40, but it does work for client authenticat |
| Smart Card Logon                                                                                                                                                                                                                                                                               | 1.3.6.1.4.1.311.20                                                                                                                                  |
| Any Purpose                                                                                                                                                                                                                                                                                    | 2.5.29                                                                                                                                              |
| SubCA                                                                                                                                                                                                                                                                                          | (no                                                                                                                                                 |
| An additional EKU OID that we found we could abuse is the Certificate Request Agent OID<br>(1.3.6.1.4.1.311.20.2.1). Certificates with this OID can be used to request certificates on behalf<br>of another user unless specific restrictions are put in place, we will look at in ESC3 place, |                                                                                                                                                     |
