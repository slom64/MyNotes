
> [!Question] 
> Contents

Yes, you're correct that Resource-Based Constrained Delegation (RBCD) does not require the evidence ticket (the TGS provided by the user or generated via S4U2self) to be forwardable, unlike traditional constrained delegation. This makes RBCD more flexible, especially in scenarios involving protocol transition or non-forwardable tickets. However, this doesn't mean the front-end service can access the back-end service "directly" without involving the KDC—impersonation still requires going through the Kerberos protocol to obtain a valid service ticket.

### Why No Forwardable Requirement in RBCD?
- In traditional constrained delegation, the KDC strictly checks if the evidence ticket is marked forwardable during the S4U2proxy request. If it's not, the request fails (e.g., with KDC_ERR_BADOPTION). This ensures the user's original intent allows delegation.
- RBCD shifts the authorization check to the back-end resource's configuration (via the `msDS-AllowedToActOnBehalfOfOtherIdentity` attribute, which lists allowed impersonators). The KDC doesn't enforce forwardability on the evidence ticket because the trust decision is resource-centric, not based on the user's ticket flags. This allows RBCD to work even with non-forwardable evidence, enabling broader use cases like cross-domain delegation or when the user's ticket wasn't requested as forwardable.

### How the Front-End Service Accesses the Back-End in RBCD
The process isn't "direct" access (e.g., no bypassing Kerberos or using raw credentials)—the front-end must still request a service ticket from the KDC on behalf of the user. Here's the flow:

1. **User Authenticates to Front-End**: The user provides authentication (Kerberos or non-Kerberos like NTLM). If non-Kerberos, the front-end uses S4U2self to generate an evidence ticket (which can be non-forwardable if protocol transition is involved).

2. **S4U2proxy Request**: The front-end sends a KRB_TGS_REQ (S4U2proxy) to the KDC, including:
   - The evidence ticket (non-forwardable is okay in RBCD).
   - The back-end's SPN as the target.
   - Its own authenticator (from the front-end's TGT).

3. **KDC Validation**: The KDC checks if the front-end is listed in the back-end's `msDS-AllowedToActOnBehalfOfOtherIdentity` (a security descriptor). If yes, it issues a new TGS for the back-end with the user's identity and authorization data (e.g., PAC). No forwardable check on evidence.

4. **Front-End to Back-End**: The front-end presents this new TGS (via KRB_AP_REQ) to the back-end, impersonating the user.

In short, RBCD relaxes the forwardable requirement to simplify configuration and cross-domain support, but the front-end still relies on the KDC for ticket issuance—there's no direct, ticketless access to the back-end. This design reduces admin overhead but can be abused if an attacker controls a low-priv front-end and configures RBCD to high-value targets.